<!-- 作者：吴俊威  日期：2018年8月 -->
<!DOCTYPE html>
<html lang="en">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<head>
{% load bootstrap4 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
    <meta charset="UTF-8">
    <title>自动化测试平台</title>
    <link rel="stylesheet" href="../static/css/bootstrap.min.css">
<script type="text/javascript" src="../static/js/jquery.min.js"></script>
<script type="text/javascript" src="../static/js/layer.js"></script>
<script type="text/javascript" src="../static/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../static/js/scripts.js"></script>
<link href="../static/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" type="text/css" href="/static/admin/css/forms.css" />
<script type="text/javascript" src="/admin/jsi18n/"></script>
<script type="text/javascript" src="/static/admin/js/vendor/jquery/jquery.js"></script>
<script type="text/javascript" src="/static/admin/js/jquery.init.js"></script>
<script type="text/javascript" src="/static/admin/js/core.js"></script>
<script type="text/javascript" src="/static/admin/js/admin/RelatedObjectLookups.js"></script>
<script type="text/javascript" src="/static/admin/js/actions.js"></script>
<script type="text/javascript" src="/static/admin/js/urlify.js"></script>
<script type="text/javascript" src="/static/admin/js/prepopulate.js"></script>
<script type="text/javascript" src="/static/admin/js/vendor/xregexp/xregexp.js"></script>
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0">
<link rel="stylesheet" type="text/css" href="/static/admin/css/responsive.css" />
<meta name="robots" content="NONE,NOARCHIVE" />
</head>
<body role="document">
<nav class="navbar navbar-expand-sm bg-dark navbar-dark fixed-top">
<div class="container">
<ul class="nav justify-content-left"> &nbsp;
</ul>
<ul class="nav justify-content-center"> &nbsp;
</ul>
<ul class="nav justify-content-end" style="position:absolute; right:10px; bottom:0px; ">
<li class="nav-link"><a style='color:white' href="#">{{user}}</a></li>
<li class="nav-link"><a style='color:white' href="/logout/">退出</a></li>
</ul>
</div>
</nav>
<div style="float:right;width:65%">
<a class="related-widget-wrapper-link add-related" id="add_id_mob" href="/admin/mobiletest/mobiletest/add/" title="新增" style="margin-right:10px;">
{#<img src="/static/admin/img/icon-addlink.svg" alt="增加"/>增加#}
</a>
<a href="#" onclick="javascript:window.location.reload() "><img src="/static/img/sx1.png" onclick="javascript:window.location.reload() "  alt="刷新" />刷新</a>
</div>
<div class="col-sm-12 text-center">
</div>
<div class="container-fluid">
	<div class="row-fluid">
		<div class="span12">
			<table class="table table-bordered table-striped table-hover">
				<thead>
					<tr>
						<th>
							<span>编号</span>
						</th>
						<th>
							<span>类型</span>
						</th>
						<th>
							<span>服务器</span>
						</th>
						<th>
							<span>创建时间</span>
						</th>
						<th>
							<span>运行状态</span>
						</th>
						<th>
							<span>操作</span>
						</th>
					</tr>
				</thead>
				<tbody>
                {% for mob in mob_list %}
					<tr>
						<td>
                            {{ mob.id }}
						</td>
						<td>
							{{ mob.pcname }}
						</td>
						<td>
							{{ mob.pcip }}
						</td>
						<td>
							{{ mob.create_time }}
						</td>
						<td>
							{{mob.runstatus}}
						</td>
						<td>
{#                            <a  href="../run_apptest/?id={{ mob.id }}" id="{{ mob.id }}" target="mainFrame" class="btn btn-success" onclick='yx({{ mob.id }});'>运行</a>#}
                            <a   id="{{ mob.id }}" {% ifequal "运行中" mob.runstatus %} disabled="true"  {% endifequal %} target="mainFrame" class="btn btn-success" onclick='runlive(this,{{ mob.id }});'>运行</a>
                             <a style='color: black' class="btn btn-success related-widget-wrapper-link add-related" id="add_id_mob" href="../admin/mobiletest/mobiletest/{{ mob.id }}/change/">编辑</a>
						</td>
					</tr>
                 {% endfor %}
				</tbody>
			</table>
		</div>
	</div>
</div>
</body>
<script type="text/javascript">
function runlive(the,id){
     layer.msg("已运行");
     //setTimeout(function(){window.location.reload();},1000);
     $("#"+id).attr({"disabled":true});
      $.ajax({
        url: "/run_livetest/",
        type:"POST",
        data:{"id":id},
        //async : false,  //异步
        success: function (e) {
            if(e=="运行完成"){layer.msg("运行完成");}
            else {layer.msg("运行异常");}
            $("#"+id).attr({"disabled":false});
            //window.location.reload();
    }
});
}
</script>
</html>